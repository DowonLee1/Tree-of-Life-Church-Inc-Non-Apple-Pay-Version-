//
//  HistoryOfRedemtionViewController.swift
//  TTOLC
//
//  Created by Dowon on 8/28/20.
//  Copyright Â© 2020 Dowon. All rights reserved.
//

import UIKit
import AudioToolbox
import MessageUI

class SecondTypeMenuViewController: UIViewController, UIScrollViewDelegate, MFMailComposeViewControllerDelegate{

    @IBOutlet weak var image: UIImageView!
    @IBOutlet weak var scrollView: UIScrollView!
    @IBOutlet weak var actionButton: UIButton!
    @IBOutlet weak var contentView: UIView!
    @IBOutlet weak var paddingView: UIView!
    @IBOutlet weak var titleLabel: UILabel!
    @IBOutlet weak var subTitleLabel: UILabel!
    @IBOutlet weak var descriptionLabel: UILabel!
    @IBOutlet weak var textViewLabel: UITextView!
    @IBOutlet weak var sinceLabel: UILabel!
    
    var passedSectionTitle = ""
    var passedIndex = 0
    var passedMainMenu = [MainMenu]()
    var navBackground = UIView()
    var statusBackground = UIView()
    var animationView = UIView()
    var shareButtonUrl = ""
    let statusBarHeight: CGFloat = UIApplication.shared.statusBarFrame.height
    
    override func viewWillDisappear(_ animated: Bool) {
        super.viewWillDisappear(animated)
        navigationController?.setNavigationBarHidden(false, animated: animated)
    }
    
    override func viewDidLoad() {
        super.viewDidLoad()
        
        layoutSetUp()
        initialAnimation()
        changbleObjects()
    }
    
    private func changbleObjects() {
        if passedSectionTitle == "ABOUT US" {
            titleLabel.text = "ABOUT US"
            subTitleLabel.text = "THE TREE OF LIFE CHURCH"
            image.image = UIImage(named: "about")
            actionButton.setTitle("CONTACT US", for: .normal)
            sinceLabel.text = "SINCE 2016 04 17"
            textViewLabel.text = "The Tree of Life Church was founded upon on the faith ideology of Reverend Abraham Park with the mission of spreading the gospel of the cross, the Word of redemptive history, to all nations. The Tree of Life Church embraces all races, languages, and cultures, as one body of Christ. Our mission statement focuses on world missions by obeying the Word of Jesus Christ to make disciples of all nations so that they may return dancing to the Lord. The Tree of Life Church breaks away from the fixed formalities and habits of the standard church and works with all congregation members to serve the church with their individual talents and passion. We aim to fulfill the vision of the current times and the ultimate vision of the Bible, which is the history of redemption."
        }
        else if passedSectionTitle == "MISSIONARY" {
            titleLabel.text = "MISSIONARY"
            subTitleLabel.text = "BY TREE OF LIFE CHURCH"
            image.image = UIImage(named: "")
            actionButton.setTitle("CONTACT US", for: .normal)
            sinceLabel.text = "SINCE 2016 10 23"
            textViewLabel.text = ""
        }
        else if passedSectionTitle == "HISTORY OF REDEMPTION" {
            titleLabel.text = "HISTORY OF REDEMPTION SERIES BOOK"
            subTitleLabel.text = "BY REV. DR. ABRAHAM PARK"
            image.image = UIImage(named: "histBooks")
            actionButton.setTitle("ABOUT BOOKS", for: .normal)
            sinceLabel.text = "SINCE 2007 10 27"
            textViewLabel.text = "In 2007, Reverend Abraham Park, the founder of Pyungkang Cheil Presbyterian Church published the first volume of the The History of Redemption series. The series sold more than 450,000, making an unprecedented record for biblical research books. What also surprised many was that the English version of the series (from volume 1 to 5 currently) also sold 30,0000 copies on Amazon.com, the largest online bookstore, and in Barnes& Noble which holds the largest bookstore network in the United States. The series has been translated not only in English but also in Chinese, Japanese, Hebrew, Spanish and Indonesian. The seminars on The History of Redemption Series took place in over 20 countries around the world."
        }
    }
    
    private func initialAnimation() {
        image.alpha = 0
        scrollView.alpha = 0
        UIView.animate(withDuration: 1.0) {
            self.animationView.alpha = 0
            self.image.alpha = 1
            self.scrollView.alpha = 1
        }
    }
    
    private func layoutSetUp() {
        animationView.frame.size.width = view.frame.size.width
        animationView.frame.size.height = view.frame.size.height
        animationView.backgroundColor = .white
        view.addSubview(animationView)
        
        image.translatesAutoresizingMaskIntoConstraints = false
        image.topAnchor.constraint(equalTo: view.topAnchor, constant: statusBarHeight).isActive = true
        image.topAnchor.constraint(equalTo: view.topAnchor).isActive = true
        image.leftAnchor.constraint(equalTo: view.leftAnchor).isActive = true
        image.rightAnchor.constraint(equalTo: view.rightAnchor).isActive = true
        image.heightAnchor.constraint(equalToConstant: CGFloat(Int(view.frame.size.height / 1.28))).isActive = true
//        image.transform = CGAffineTransform(scaleX: 1.2, y: 1.2)
        
        let navBarHeight = statusBarHeight +
           (navigationController?.navigationBar.frame.height ?? 0.0)
        actionButton.layer.borderWidth = 1
        actionButton.layer.borderColor = UIColor.black.cgColor
        
        
        scrollView.translatesAutoresizingMaskIntoConstraints = false
        scrollView.topAnchor.constraint(equalTo: view.topAnchor, constant: navBarHeight).isActive = true
        scrollView.leftAnchor.constraint(equalTo: view.leftAnchor).isActive = true
        scrollView.rightAnchor.constraint(equalTo: view.rightAnchor).isActive = true
        scrollView.bottomAnchor.constraint(equalTo: view.bottomAnchor).isActive = true
        
        // if screen ratio is 16:9
        if view.frame.size.height <= view.frame.size.width * 2{
            print("screen ratio is 16:9 as iphone 8")
            scrollView.contentSize = CGSize(width: view.frame.size.width, height: paddingView.frame.size.height + contentView.frame.size.height - navBarHeight + ((statusBarHeight) * 3))
        }
        // if screen ratio is 21:9
        else if view.frame.size.height >= view.frame.size.width * 2{
            print("screen ratio is 21:9 as iphone x")
            scrollView.contentSize = CGSize(width: view.frame.size.width, height: paddingView.frame.size.height + contentView.frame.size.height - navBarHeight + ((statusBarHeight / 5) * 2))
        }
        scrollView.delegate = self
        
        contentView.translatesAutoresizingMaskIntoConstraints = false
        contentView.heightAnchor.constraint(equalToConstant: CGFloat(scrollView.frame.size.height)).isActive = true
        contentView.leftAnchor.constraint(equalTo: view.leftAnchor).isActive = true
        contentView.rightAnchor.constraint(equalTo: view.rightAnchor).isActive = true
        contentView.topAnchor.constraint(equalTo: paddingView.bottomAnchor).isActive = true
        contentView.layer.shadowOffset = CGSize(width: 0, height: 1)
        contentView.layer.shadowOpacity = 0.2
        contentView.layer.shadowColor = UIColor.black.cgColor
        
        paddingView.translatesAutoresizingMaskIntoConstraints = false
        paddingView.topAnchor.constraint(equalTo: scrollView.topAnchor).isActive = true
        paddingView.leftAnchor.constraint(equalTo: view.leftAnchor).isActive = true
        paddingView.rightAnchor.constraint(equalTo: view.rightAnchor).isActive = true
        paddingView.heightAnchor.constraint(equalToConstant: CGFloat(view.frame.size.height / 1.628)).isActive = true
        
        navBackground.backgroundColor = .white
        navBackground.frame.size.width = view.frame.size.width
        navBackground.frame.size.height = navBarHeight
        navBackground.alpha = 0
        view.addSubview(navBackground)
        
        statusBackground.backgroundColor = .white
        statusBackground.frame.size.width = view.frame.size.width
        statusBackground.frame.size.height = statusBarHeight
        view.addSubview(statusBackground)
    }
    
    @IBAction func didChangeSegment(_ sender: UISegmentedControl) {
        if sender.selectedSegmentIndex == 0 {
            if passedIndex == 1 {
                textViewLabel.text = "The Tree of Life Church was founded upon on the faith ideology of Reverend Abraham Park with the mission of spreading the gospel of the cross, the Word of redemptive history, to all nations. The Tree of Life Church embraces all races, languages, and cultures, as one body of Christ. Our mission statement focuses on world missions by obeying the Word of Jesus Christ to make disciples of all nations so that they may return dancing to the Lord. The Tree of Life Church breaks away from the fixed formalities and habits of the standard church and works with all congregation members to serve the church with their individual talents and passion. We aim to fulfill the vision of the current times and the ultimate vision of the Bible, which is the history of redemption."
            }
            if passedIndex == 3 {
                textViewLabel.text = "In 2007, Reverend Abraham Park, the founder of Pyungkang Cheil Presbyterian Church published the first volume of the The History of Redemption series. The series sold more than 450,000, making an unprecedented record for biblical research books. What also surprised many was that the English version of the series (from volume 1 to 5 currently) also sold 30,0000 copies on Amazon.com, the largest online bookstore, and in Barnes& Noble which holds the largest bookstore network in the United States. The series has been translated not only in English but also in Chinese, Japanese, Hebrew, Spanish and Indonesian. The seminars on The History of Redemption Series took place in over 20 countries around the world."
            }
            
            textViewLabel.alpha = 0
            AudioServicesPlaySystemSound(1519)
            UIView.animate(withDuration: 1.0) {
                self.textViewLabel.alpha = 1
            }
            
        }
        else if sender.selectedSegmentIndex == 1 {
            if passedIndex == 1 {
                textViewLabel.text = "ìëª ëë¬´ êµíë ì­ìê°ì ë³µì, êµ¬ìì¬ ë§ìì ëª¨ë  ë¯¼ì¡±ì ì ííë¤ë ì¬ëªì¼ë¡ ë° ìë¸ë¼í¨ ëª©ì¬ì ì ì ì´ëì ë°íì¼ë¡ ì¤ë¦½ëììµëë¤. ìëª ëë¬´ êµíë ëª¨ë  ì¸ì¢, ì¸ì´, ë¬¸íë¥¼ ê·¸ë¦¬ì¤ëì í ëª¸ì¼ë¡ ë°ìë¤ìëë¤. ì°ë¦¬ì ì¬ëª ì ì¸ë¬¸ì ìì ê·¸ë¦¬ì¤ëì ë§ìì ìì¢íì¬ ëª¨ë  ë¯¼ì¡±ì ì ìë¥¼ ì¼ì ì£¼ë ê» ì¶¤ì ì¶ëë¡í¨ì¼ë¡ì¨ ì¸ê³ ì êµì ì´ì ì ë§ì¶ê³  ììµëë¤. ìëª ëë¬´ êµíë íì¤ êµíì ê³ ì  ë íìê³¼ ìµê´ìì ë²ì´ë ëª¨ë  ì±ëë¤ê³¼ íë ¥íì¬ ê°ìì ì¬ë¥ê³¼ ì´ì ì¼ë¡ êµíë¥¼ ì¬ê¸°ê³  ììµëë¤. êµ¬ìì ì­ì¬ ì¸ ì±ê²½ì íì¬ ë¹ì ê³¼ ê¶ê·¹ì  ì¸ ë¹ì ì ì±ì·¨íê³ ìí©ëë¤."
            }
            if passedIndex == 3 {
                textViewLabel.text = "2007ë íê° ì ì¼ ì¥ë¡ êµí ì°½ë¦½ìì¸ ë° ìë¸ë¼í¨ ëª©ì¬ë êµ¬ìì¬ ìë¦¬ì¦ 1ê¶ì ë°ê°íë¤. ì´ ìë¦¬ì¦ë 45ë§ê°ê° ëë íë§¤ëì¼ë¡ ì±ê²½ ì°êµ¬ ìì ì ì ë¡ìë ê¸°ë¡ì ì¸ì ìµëë¤. ëí ë§ì ì¬ëë¤ì´ ëëê²ì ì´ ìë¦¬ì¦ì ìì´ ë²ì  (íì¬ 1 ê¶ìì 5 ê¶ê¹ì§)ì´ ââìµë ì¨ë¼ì¸ ìì  ì¸ Amazon.comê³¼ ë¯¸êµ­ ìµë ìì  ë¤í¸ìí¬ë¥¼ ë³´ì í Barnes & Nobleìì 30,0000 ë¶ë¥¼ íë§¤íë¤ë ê²ìëë¤. ì´ ìë¦¬ì¦ë ìì´ë¿ë§ ìëë¼ ì¤êµ­ì´, ì¼ë³¸ì´, íë¸ë¦¬ì´, ì¤íì¸ì´ ë° ì¸ëë¤ììì´ë¡ë ë²ì­ëììµëë¤. The History of Redemption Seriesì ëí ì¸ë¯¸ëë ì  ì¸ê³ 20ì¬ ê°êµ­ìì ì´ë ¸ìµëë¤."
            }
            
            textViewLabel.alpha = 0
            AudioServicesPlaySystemSound(1519)
            UIView.animate(withDuration: 1.0) {
                self.textViewLabel.alpha = 1
            }
        }
        else if sender.selectedSegmentIndex == 2 {
            if passedIndex == 1 {
                textViewLabel.text = "La Iglesia Tree of Life se fundÃ³ sobre la ideologÃ­a de fe del Reverendo Abraham Park con la misiÃ³n de difundir el evangelio de la cruz, la Palabra de la historia redentora, a todas las naciones. La Iglesia Ãrbol de la Vida abarca todas las razas, idiomas y culturas como un solo cuerpo de Cristo. Nuestra declaraciÃ³n de misiÃ³n se enfoca en misiones mundiales al obedecer la Palabra de Jesucristo para hacer discÃ­pulos de todas las naciones para que puedan regresar bailando al SeÃ±or. La Iglesia Ãrbol de la Vida rompe con las formalidades y hÃ¡bitos fijos de la iglesia estÃ¡ndar y trabaja con todos los miembros de la congregaciÃ³n para servir a la iglesia con sus talentos y pasiÃ³n individuales. Nuestro objetivo es cumplir la visiÃ³n de los tiempos actuales y la visiÃ³n Ãºltima de la Biblia, que es la historia de la redenciÃ³n."
            }
            if passedIndex == 3 {
                textViewLabel.text = "En 2007, el Reverendo Abraham Park, fundador de la Iglesia Presbiteriana Pyungkang Cheil, publicÃ³ el primer volumen de la serie La Historia de la RedenciÃ³n. La serie vendiÃ³ mÃ¡s de 450,000, haciendo un rÃ©cord sin precedentes para los libros de investigaciÃ³n bÃ­blica. Lo que tambiÃ©n sorprendiÃ³ a muchos fue que la versiÃ³n en inglÃ©s de la serie (del volumen 1 al 5 actualmente) tambiÃ©n vendiÃ³ 30,0000 copias en Amazon.com, la librerÃ­a en lÃ­nea mÃ¡s grande, y en Barnes & Noble, que posee la red de librerÃ­as mÃ¡s grande de los Estados Unidos. . La serie ha sido traducida no solo al inglÃ©s, sino tambiÃ©n al chino, japonÃ©s, hebreo, espaÃ±ol e indonesio. Los seminarios sobre la serie La historia de la redenciÃ³n se llevaron a cabo en mÃ¡s de 20 paÃ­ses de todo el mundo."
            }
            
            textViewLabel.alpha = 0
            AudioServicesPlaySystemSound(1519)
            UIView.animate(withDuration: 1.0) {
                self.textViewLabel.alpha = 1
            }
        }
        else if sender.selectedSegmentIndex == 3 {
            if passedIndex == 1 {
                textViewLabel.text = "Gereja Pohon Kehidupan didirikan di atas ideologi iman Pendeta Abraham Park dengan misi menyebarkan Injil salib, Firman sejarah penebusan, ke semua bangsa. Gereja Pohon Kehidupan merangkul semua ras, bahasa, dan budaya, sebagai satu tubuh Kristus. Pernyataan misi kami berfokus pada misi dunia dengan mematuhi Firman Yesus Kristus untuk menjadikan semua bangsa murid sehingga mereka dapat kembali menari kepada Tuhan. The Tree of Life Church memisahkan diri dari formalitas dan kebiasaan tetap gereja standar dan bekerja dengan semua anggota jemaat untuk melayani gereja dengan bakat dan semangat individu mereka. Kami bertujuan untuk memenuhi visi zaman sekarang dan visi akhir dari Alkitab, yaitu sejarah penebusan."
            }
            if passedIndex == 3 {
                textViewLabel.text = "Pada tahun 2007, Pendeta Abraham Park, pendiri Gereja Presbyterian Pyungkang Cheil menerbitkan volume pertama seri The History of Redemption. Seri tersebut terjual lebih dari 450.000, membuat rekor yang belum pernah terjadi sebelumnya untuk buku-buku penelitian alkitabiah. Yang juga mengejutkan banyak orang adalah bahwa versi bahasa Inggris dari serial tersebut (dari volume 1 hingga 5 saat ini) juga terjual 30.0000 eksemplar di Amazon.com, toko buku online terbesar, dan di Barnes & Noble yang memegang jaringan toko buku terbesar di Amerika Serikat. . Serial ini telah diterjemahkan tidak hanya dalam bahasa Inggris tetapi juga dalam bahasa Cina, Jepang, Ibrani, Spanyol dan Indonesia. Seminar tentang The History of Redemption Series berlangsung di lebih dari 20 negara di seluruh dunia."
            }
            textViewLabel.alpha = 0
            AudioServicesPlaySystemSound(1519)
            UIView.animate(withDuration: 1.0) {
                self.textViewLabel.alpha = 1
            }
        }
        else if sender.selectedSegmentIndex == 4 {
            if passedIndex == 1 {
                textViewLabel.text = "çå½ä¹æ æä¼çå»ºç«åºäºç§å¸äºä¼¯æç½Â·å¸åï¼Reverend Abraham Parkï¼çä¿¡ä»°ææ³ï¼å¶ä½¿å½æ¯åææå½å®¶ä¼ æ­åå­æ¶çç¦é³ï¼æèµåå²çéãçå½ä¹æ æä¼åå«ææç§æï¼è¯­è¨åæåï¼æ¯åºç£çèº«ä½ãæä»¬çå®£æå£°æéä¸­å¨ä¸çå®£æä¸ï¼éµå®è¶ç¨£åºç£çå£è¨ï¼ä½¿ä¸æ°ä½é¨å¾ï¼ä½¿ä»ä»¬å¯ä»¥è·³èå½ä¸»ãçå½ä¹æ æä¼æè±äºæ åæä¼çåºå®å½¢å¼åä¹ æ¯ï¼å¹¶ä¸ææä¼ä¼ä¸èµ·åªåï¼ä»¥èªå·±çæååç­æä¸ºæä¼æå¡ãæä»¬çç®æ æ¯å®ç°å½ä»æ¶ä»£çæ¿æ¯åå£ç»çæç»æ¿æ¯ï¼è¿æ¯æèµçåå²ã"
            }
            if passedIndex == 3 {
                textViewLabel.text = "Pyungkang Cheilé¿èä¼çåå§äººReverend Abraham Parkäº2007å¹´åºçäºãæèµå²ãç³»åçç¬¬ä¸å·ãè¯¥ç³»åä¹¦çééè¶è¿äº450,000ï¼åä¸äºå£ç»ç ç©¶ä¹¦ç±çç©ºåçºªå½ãä»¤äººæè®¶çæ¯ï¼è¯¥ç³»åçè±æçï¼ç®åä»ç¬¬1å·å°ç¬¬5å·ï¼è¿å¨æå¤§çå¨çº¿ä¹¦åºAmazon.comåæ¥æç¾å½æå¤§çä¹¦åºç½ç»çBarnesï¼Nobleä¸ååºäº30,0000åã ãè¯¥ç³»åä¸ä»ç¿»è¯æè±æï¼è¿ç¿»è¯æä¸­æï¼æ¥æï¼å¸ä¼¯æ¥æï¼è¥¿ç­çæåå°åº¦å°¼è¥¿äºæãèµååå²ç³»åç è®¨ä¼å¨å¨ç20å¤ä¸ªå½å®¶ä¸¾è¡ã"
            }
            textViewLabel.alpha = 0
            UIView.animate(withDuration: 1.0) {
                self.textViewLabel.alpha = 1
            }
        }
    }
    
    @IBAction func actionButtonClicked(_ sender: UIButton) {
        if passedSectionTitle != "HISTORY OF REDEMPTION" {
            if !MFMailComposeViewController.canSendMail() {
                actionButton.shake()
            }
            sendEmail()
            AudioServicesPlaySystemSound(1519)
        }
        else {
            let vc = storyboard?.instantiateViewController(withIdentifier: "CollectionViewController") as? CollectionViewController
            AudioServicesPlaySystemSound(1519)
            self.navigationController?.pushViewController(vc!, animated: true)
        }
    }
    
    @IBAction func shareButtonClicked(_ sender: UIButton) {
        if passedSectionTitle == "ABOUT US" {
            shareButtonUrl = "http://nytreeoflife.com/"
        }
        if passedSectionTitle == "MISSIONARY" {
            shareButtonUrl = "http://nytreeoflife.com/missions-2/"
        }
        if passedSectionTitle == "HISTORY OF REDEMPTION BOOK" {
            shareButtonUrl = "http://horaministries.com/about-the-books/"
        }
        let items = [shareButtonUrl]
        let ac = UIActivityViewController(activityItems: items, applicationActivities: nil)
        present(ac, animated: true)
        AudioServicesPlaySystemSound(1519)
        
    }
    
    func scrollViewDidScroll(_ scrollView: UIScrollView) {
        let alpha: CGFloat = abs(1 - ((scrollView.contentOffset.y + paddingView.frame.size.height) / paddingView.frame.size.height))
        let fade: CGFloat = abs(2 - ((scrollView.contentOffset.y + paddingView.frame.size.height) / paddingView.frame.size.height))
        image.transform = CGAffineTransform(scaleX: 0.8 + ((fade / 10) * 2), y: 0.8 + ((fade / 10) * 2))
        navBackground.alpha = alpha
        if (alpha >= 0.99 && alpha <= 1.00) || (alpha == 0) {
            AudioServicesPlaySystemSound(1519)
        }
    }
    
    private func sendEmail() {
        let composeVC = MFMailComposeViewController()
        composeVC.mailComposeDelegate = self
        // Configure the fields of the interface.
        composeVC.setToRecipients(["info.ttolc@gmail.com"])
        composeVC.setSubject("Request")
        composeVC.setMessageBody("Hello Tree of life church, ", isHTML: false)
        // Present the view controller modally.
        self.present(composeVC, animated: true, completion: nil)
    }

    private func mailComposeController(controller: MFMailComposeViewController,
                           didFinishWithResult result: MFMailComposeResult, error: NSError?) {
        controller.dismiss(animated: true, completion: nil)
    }
}


